{% extends 'PC/base/baseForm.html' %}
{% block title %}
更改客户信息
{% endblock %}
{% block body-title %}
更改客户信息
{% endblock %}
{% block style %}
<style>
    .pure-form-aligned .pure-control-group label{
        width: 7em;
    }
@media screen and (min-width: 768px) {
    textarea{
        height: 17em;
    }
}
</style>
{% endblock %}
{% block form %}
<div class="pure-g">
<div class="pure-u-1 pure-u-xl-1-2">
    <div class="pure-control-group">
        <label for="name">客户名称</label>
        <input type="text" id="name" name="name" value="{{ customer.name }}" required maxlength="50"/>
    </div>
    <div class="pure-control-group">
        <label for="contact">联系人</label>
        <input type="text" id="contact" name="contact" value="{{ customer.contact }}" maxlength="20" required/>
    </div>
    <div class="pure-control-group">
        <label for="tel">联系方式</label>
        <input type="text" id="tel" name="tel" value="{{ customer.tel }}" maxlength="20" required/>
    </div>
    <div class="pure-control-group">
        <label for="project_name">项目名称</label>
        <input type="text" id="project_name" name="project_name" value="{{ customer.project_name }}" maxlength="50" required/>
    </div>
    <div class="pure-control-group">
        <label for="project_amount">项目金额</label>
        <input type="text" id="project_amount" name="project_amount" value="{{ customer.project_amount }}" maxlength="20" required/>
    </div>
    <div class="pure-control-group">
        <label for="payment_method">付款方式</label>
        <input type="text" id="payment_method" name="payment_method" value="{{ customer.payment_method }}" maxlength="20" required/>
    </div>
</div>
<div class="pure-u-1 pure-u-xl-1-2">
    <div class="pure-control-group">
        <label for="mark">项目技术要求或主要条款</label>
        <textarea id="mark" name="mark" maxlength="1000" required>{{customer.mark}}</textarea>
    </div>
</div>
</div>
{% endblock %}
{% block button-text %}
<i class="iconfont icon-wancheng"></i> 提交
{% endblock %}
{% block script %}
<script>
$(document).ready(function () {
    let error = $('.error');
    let login_button = $('.form-button');
    login_button.click(function () {
        login_button.html('<i class="iconfont icon-jiazai"></i> 请稍后...').attr('disabled', 'disabled');  // 改变button中的文字
        if (NoEmpty('<i class="iconfont icon-wancheng"></i> 提交', error, login_button)) {
            $.ajax({
                url: "{% url 'BPlan:customer_change_detail' %}",
                type: 'POST',
                data: {
                    'id': {{ customer.id }},
                    'name': $('#name').val(),
                    'contact': $('#contact').val(),
                    'tel': $('#tel').val(),
                    'project_name': $('#project_name').val(),
                    'project_amount': $('#project_amount').val(),
                    'payment_method': $('#payment_method').val(),
                    'mark': $('#mark').val(),
                    "csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val(),
                },
                success: function () {
                    error.text("");
                    $("form").hide(1000);
                    $(".body-title").html("修改成功！");
                    return 1;
                },
            })
        }

    })
})
</script>
{% endblock %}